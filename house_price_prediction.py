# -*- coding: utf-8 -*-
"""House_Price_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Tb_SDAxNT3hA3I7Av1gNq6Jq9LOzh3NR
"""

import pandas as pd
data = pd.read_csv('/content/Housing.csv')

data.head()

data.isnull().sum()

data.describe()

data.shape

data.dtypes

data['furnishingstatus'].value_counts()

binary_columns = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_columns:
  data[col] = data[col].map({'yes' : 1, 'no' : 0})

print(data.head())

furnishing_dummies = pd.get_dummies(data['furnishingstatus'],dtype=int,prefix='furnishing')
data = pd.concat([data,furnishing_dummies],axis=1)
data.drop('furnishingstatus',axis=1,inplace = True)

print(data.head())

data.dtypes

data.to_csv("Modified Dataset",index=False)

correlation = data.corr()

import seaborn as sns

sns.heatmap(correlation,cbar = True,annot=True,cmap='Reds',fmt='.1f',annot_kws={'size':8})

X = data.drop(['price'],axis=1)

Y = data['price']

print(X)
print(Y)

from sklearn.model_selection import train_test_split
X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.2,random_state=42)

print(X.shape,X_train.shape,X_test.shape)

from xgboost import XGBRegressor
model = XGBRegressor(max_depth = 3)

model.fit(X_train,Y_train)

Training_data_Prediction = model.predict(X_train)

print(Training_data_Prediction)

from sklearn import metrics
score1 = metrics.r2_score(Y_train,Training_data_Prediction)
score2 = metrics.mean_absolute_error(Y_train,Training_data_Prediction)

print("R2 Score : ",score1)
print("Mean Absolute Error :",score2)

plt.scatter(Y_train,Training_data_Prediction)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual Prices vs Predicted Prices")

Test_data_Prediction = model.predict(X_test)

from sklearn import metrics
score1 = metrics.r2_score(Y_test,Test_data_Prediction)
score2 = metrics.mean_absolute_error(Y_test,Test_data_Prediction)

print("R2 Score : ",score1)
print("Mean Absolute Error :",score2)

plt.scatter(Y_test,Test_data_Prediction)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual Prices vs Predicted Prices")

import numpy as np

input = (6000,4,2,4,1,0,0,0,1,0,0,0,0,1)
input_array = np.asarray(input)
reshaped_data = input_array.reshape(1,-1)

predicted_price = model.predict(reshaped_data)

print("Price of House is :",predicted_price)

